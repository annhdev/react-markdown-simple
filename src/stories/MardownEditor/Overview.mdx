import { Canvas, Meta } from '@storybook/addon-docs/blocks';
import * as MarkdownEditorPreview from './index.stories';
import Table from "../Table/index.tsx";

<Meta title="MarkdownEditor Preview" of={MarkdownEditorPreview} />

# Markdown Editor Component

![Demo](./markdown-editor-demo.png)

[![npm](https://img.shields.io/npm/v/react-markdown-simple)](https://www.npmjs.com/package/react-markdown-simple)[![npm](https://img.shields.io/npm/dm/react-markdown-simple)](https://www.npmjs.com/package/react-markdown-simple)[![NPM](https://img.shields.io/npm/l/react-markdown-simple)](https://www.npmjs.com/package/react-markdown-simple)

The `MarkdownEditor` component provides a user-friendly interface for writing and previewing Markdown content. It includes features such as syntax highlighting, live preview, and toolbar options for common formatting actions.

## Get Started

- [Features](#features)
- [Installation](#installation)
- [Demo](#demo)
- [Configuration](#configuration)
- [Plugins](#plugins)
- [Customization](#customization)
- [Contributing](#contributing)
- [Troubleshooting](#troubleshooting)
- [Support or Donate](#donate)
- [Roadmap](#roadmap)
- [License](#license)

## <a id="features"></a>‚ú® Features

- Syntax Highlighting (Very simple)
- Live Preview
- Toolbar with Formatting Options (Allow customization)
- Scroll Synchronization between Editor and Preview
- Read-Only Mode
- Character and Word Limit Enforcement
- Customizable Themes and Fonts (Dark Mode Support)
- Easy Integration with React Applications
- Integration with Tailwind CSS or other CSS frameworks
- Plugin System for Extending Functionality

## <a id="installation"></a>üíé Installation

```
npm i react-markdown-simple
```

To use the `MarkdownEditor` component, import it into your React application and include it in your JSX code. You can customize its behavior through various props.

```jsx
import React, { useState } from 'react';
import { MarkdownEditor } from 'react-markdown-simple';

import 'react-markdown-simple/style.min.css';

const App = () => {
  const [content, setContent] = useState('# Hello, Markdown!');

  return (
    <MarkdownEditor
      value={content}
      onChange={setContent}
      plugins={[]}
      scrollSync={true}
      preview={true}
      readOnly={false}
      customFonts={[]}
      defaultFont={'monospace'}
    />
  );
};
export default App;
```

## <a id="demo"></a>üíé Demo

<Canvas>
  <MarkdownEditorPreview.Demo />
</Canvas>


## <a id="configuration"></a>üîß Configuration

<Table
    headers={['Prop Name', 'Type', 'Default', 'Description']}
    rows={[
        ['value', 'string', '', 'The initial Markdown content.'],
        ['onChange', 'function', '(value) => void', 'Callback function when content changes.'],
        ['scrollSync', 'boolean', 'true', 'If true, synchronizes scrolling between editor and preview.'],
        ['preview', 'boolean', 'true', 'If true, shows the live preview pane.'],
        ['showPreviewHeader', 'boolean', 'true', 'If true, shows the preview header.'],
        ['readOnly', 'boolean', 'false', 'If true, makes the editor read-only.'],
        ['customFonts', 'array', 'string[]', 'Array of custom fonts available in the editor.'],
        ['defaultFont', 'string', "'monospace'", 'The default font for the editor content.'],
        ['plugins', 'array', '[]', 'Array of plugins to extend editor functionality.'],
        ['className', 'string', "''", 'Additional CSS class for custom styling.'],
        ['toolbar', 'string[][]', "DEFAULT_TOOLBAR", 'Custom toolbar configuration.'],
        ['wordLimit', 'number', "undefined", 'Optional word limit for the editor content.'],
        ['characterLimit', 'number', "undefined", 'Optional character limit for the editor content.'],
        ['showToolbar', 'boolean', "true", 'If true, displays the toolbar.'],
        ['showFooterBar', 'boolean', "true", 'If true, displays the footer bar.'],
    ]}
/>

## <a id="plugins"></a>üîå Plugins

The `MarkdownEditor` supports various plugins to enhance its functionality. Here are some commonly used plugins:
- **CodeBlock Plugin**: Enables syntax highlighting for code blocks.
- **Youtube Plugin**: Allows embedding YouTube videos directly in the editor.
- **RawImage Plugin**: Allows embedding images using raw tag `img` in markdown.
- **RawLink Plugin**: Allows embedding links using raw tag `a` in markdown.

To use a plugin, simply import it and include it in the `plugins` prop of the `MarkdownEditor` component.

### Create Your Own Plugin
You can create custom plugins to add specific features to the `MarkdownEditor`. A plugin is typically a function that takes the editor instance as an argument and modifies its behavior.

```js
import { MarkdownPlugin, EditorHelpers } from 'react-markdown-simple'

export const CustomPlugin: MarkdownPlugin = {
    name: 'Custom plugin', // Unique name for the plugin
    icon: Icon, // Replace with your icon component
    tooltip: 'My Custom Plugin', // Tooltip text
    toolbarOrder: 1, // Position in the toolbar
    showInToolbar: true, // Whether to show in the toolbar
    transform: (content: string) => {

        // Custom transformation logic
        return content.replace(/!youtube\[(.*?)]\((.*?)\)/g, (_match, title, url) => {
            return `<iframe width="560" height="315" src="${url}" title="${title}" frameborder="0" allowfullscreen></iframe>`
        })
    },

    // Function to handle toolbar button click
    onToolbarClick: (helpers: EditorHelpers) => {

        // Open a dialog to get video title and URL
        helpers.openDialog({
            title: 'Embed YouTube Video',
            fields: [
                {
                    key: 'title',
                    label: 'Video Title',
                    type: 'text',
                    placeholder: 'Enter video title',
                },
                {
                    key: 'url',
                    label: 'YouTube URL',
                    type: 'text',
                    placeholder: 'https://www.youtube.com/watch?v=VIDEO_ID',
                },
            ],
            // Callback when the dialog is confirmed
            onConfirm: (data: Record<string, string>) => {
                const markdown = `!youtube[${data.title}](${data.url})`

                // Insert the generated markdown into the editor
                helpers.insertText(markdown)
            },
        })
    },
}
```

This example plugin adds a toolbar button that opens a dialog for embedding YouTube videos. When the user fills out the form and confirms, the appropriate Markdown syntax is inserted into the editor.

## <a id="customization"></a>üé® Customization
You can customize the appearance of the `MarkdownEditor` by applying your own CSS styles or using Tailwind CSS classes. The component accepts a `className` prop for adding custom classes.

If you using Tailwind CSS, you don't need to import the default styles, as Tailwind will handle the styling for you. Some fonts are recommended for better code readability. You can include them in your Tailwind CSS configuration as follows:

```css
@charset "UTF-8";

/* Import custom fonts for better code readability */
@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Noto+Sans+Mono:wght@100..900&family=Oxygen+Mono&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap');

@import "tailwindcss";

/* Add this line so that TailwindCSS can detect your component markdown editor.*/
@source "../node_modules/react-markdown-simple";
```

You can use our styles or not, simply by removing the import statement:
```jsx
import 'react-markdown-simple/style.min.css';
```
and then apply your own styles using Tailwind CSS or any other CSS framework.

### Dark Mode
The `MarkdownEditor` supports dark mode for better readability in low-light environments. You can enable dark mode by applying a dark theme CSS class to the editor container or by using a theme provider in your application.

- Add `dark` class to the editor container:
```html
<div className="markdown-editor dark">
  <MarkdownEditor ... />
</div>
```
or
- Add `data-mode="dark"` attribute to the editor container:
```html
<div className="markdown-editor" data-mode="dark">
  <MarkdownEditor ... />
</div>
```

## <a id="contributing"></a>ü§ù Contributing
Contributions to the `MarkdownEditor` component are welcome! If you find a bug or have a feature request, please open an issue on the GitHub repository. Pull requests are also encouraged.

## <a id="troubleshooting"></a>üêõ Troubleshooting
If you encounter any issues while using the `MarkdownEditor`, please check the following:
- Ensure you have the latest version of the component installed.
- Check the GitHub issues page for known problems and solutions.
- If you still need help, feel free to open a new issue with detailed information about the problem.

## ‚ù§Ô∏è Support or Donate
If you find this project useful and would like to support its development, consider making a donation. You can donate via [GitHub Sponsors](https://github.com/sponsors/annhdev).

[![PayPal](https://www.paypalobjects.com/webstatic/i/logo/rebrand/ppcom.svg)](https://www.paypal.me/annhdev)

<img src="public/bmc_qr.png" width="200px" alt="Buy me a beer" />

## <a id="roadmap"></a>üõ£Ô∏è Roadmap
Planned features and improvements for future releases include:
- Additional Plugins for Extended Functionality
- Enhanced Customization Options
- Improved Performance and Responsiveness
- Better Accessibility Support
- Integration with More CSS Frameworks

## Licensing
The `MarkdownEditor` component is open-source and available under the MIT License. Feel free to use, modify, and distribute it in your projects.

